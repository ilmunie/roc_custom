<?xml version="1.0"?>
<odoo>




<record id="crm_lead_oppor_custom" model="ir.ui.view">
        <field name="name">crm_lead_tree_custom_opp</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_oppor"/>
        <field name="arch" type="xml">




            <xpath expr="//field[@name='name']" position="before">
                <field name="link_to_form" string="         " />
                <field name="create_date" optional="show"/>
            </xpath>
            <xpath expr="//field[@name='contact_name']" position="replace">
                <field name="partner_id"/>
                <field name="zip" optional="show"/>
            </xpath>
            <xpath expr="//field[@name='phone']" position="replace">
                <field name="phone_resume" widget="copy_phone"/>
                <field name="date_deadline"/>
            </xpath>
            <xpath expr="//field[@name='my_activity_date_deadline']" position="attributes">
                <attribute name="optional">hide</attribute>
            </xpath>
            <xpath expr="//field[@name='expected_revenue']" position="attributes">
                <attribute name="optional">hide</attribute>
            </xpath>
            <xpath expr="//field[@name='stage_id']" position="after">
                <field name="datetime_in_stage" widget="remaining_days"/>
                    <field name="team_id" optional="show" options="{'no_open': True, 'no_create': True}" domain="[('id','!=',False)]"/>
                   <!-- <field name="customer_concern"/>-->
                    <field name="company_concern" widget="priority"/>
                    <field name="type_of_client"/>
                    <field string="Tipo de trabajo" name="work_type_id" options="{'create': False,'create_edit': False}"/>
                    <field string="Productos de interés" name="intrest_tag_ids" widget="many2many_tags" options="{'create': False,'create_edit': False}"/>
                    <field name="priority" widget="priority"/>
                    <field name="tag_ids" string="Etiquetas" optional="show" widget="many2many_tags" options="{'create':False,'create_edit':False,'color_field': 'color'}"/>
                    <field name="installation"/>
            </xpath>
        </field>
    </record>


    <record id="crm_lead_tree_custom" model="ir.ui.view">
        <field name="name">crm_lead_tree_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_leads"/>
        <field name="arch" type="xml">
            <xpath expr="//tree[last()]" position="replace">
                <tree string="Leads" sample="1" multi_edit="1" >
                    <field name="link_to_form" string="         " />
                     <field name="date_deadline" invisible="1"/>
                    <field name="create_date" optional="show"/>
                    <field name="name" string="Lead"/>
                    <field name="contact_name" optional="hide"/>
                    <field name="partner_name" optional="hide"/>
                    <field name="email_from" optional="show"/>
                    <field name="phone_resume" widget="copy_phone"/>
                    <field name="company_id" groups="base.group_multi_company" optional="hide"/>
                    <field name="zip" optional="show"/>
                    <field name="city" optional="show"/>
                    <field name="state_id" optional="hide" options="{'no_open': True, 'no_create': True}"/>
                    <field name="country_id" optional="hide" options="{'no_open': True, 'no_create': True}"/>
                    <field name="partner_id" invisible="1"/>
                    <field name="team_id" optional="show" options="{'no_open': True, 'no_create': True}" domain="[('id','!=',False)]"/>
                    <field name="user_id" invisible="0" options="{'no_open': True, 'no_create': True}" domain="[('share', '=', False)]"/>

                    <field name="active" invisible="1"/>
                    <field name="campaign_id" optional="hide"/>
                    <field name="referred" invisible="1"/>
                    <field name="medium_id" optional="show" options="{'no_open': True, 'no_create': True}"/>
                    <field name="source_id" optional="show" options="{'no_open': True, 'no_create': True}"/>
                    <!--<field name="customer_concern"/>-->
                    <field name="company_concern" widget="priority"/>

                    <field name="type_of_client"/>
                    <field string="Tipo de trabajo" name="work_type_id" options="{'create': False,'create_edit': False}"/>
                    <field string="Productos de interés" name="intrest_tag_ids" widget="many2many_tags" options="{'create': False,'create_edit': False}"/>
                    <field name="probability" string="Probability (%)" optional="hide"/>
                    <field name="message_needaction" invisible="1"/>
                    <field name="description" widget="text_widget" readonly="1" />
                    <field name="priority" widget="priority"/>
                    <field name="tag_ids" string="Etiquetas" optional="show" widget="many2many_tags" options="{'create':False,'create_edit':False,'color_field': 'color'}"/>
                    <field name="activity_ids" widget="list_activity"/>
                    <field name="installation"/>
                    <field name="lead_stage_id"/>
                <field name="datetime_in_lead_stage" widget="remaining_days"/>
                </tree>

            </xpath>
        </field>
    </record>
    <record id="crm_lead_tree_original" model="ir.ui.view">
        <field name="name">crm_lead_tree_original</field>
        <field name="model">crm.lead</field>
        <field name="arch" type="xml">
                <tree string="Leads" sample="1">
                    <field name="link_to_form" string="         " />
                     <field name="date_deadline" invisible="1"/>
                    <field name="create_date" optional="show"/>
                    <field name="name" string="Lead"/>
                    <field name="contact_name" optional="hide"/>
                    <field name="partner_name" optional="hide"/>
                    <field name="email_from" optional="show"/>
                    <field name="phone_resume" widget="copy_phone"/>
                    <field name="company_id" groups="base.group_multi_company" optional="hide"/>
                    <field name="zip" optional="show"/>
                    <field name="city" optional="show"/>
                    <field name="state_id" optional="hide" options="{'no_open': True, 'no_create': True}"/>
                    <field name="country_id" optional="hide" options="{'no_open': True, 'no_create': True}"/>
                    <field name="partner_id" invisible="1"/>
                    <!-- Explicit domain due to multi edit -> real company domain would be complicated -->
                    <field name="team_id" optional="show" options="{'no_open': True, 'no_create': True}" domain="[('id','!=',False)]"/>
                    <field name="user_id" invisible="0" options="{'no_open': True, 'no_create': True}" domain="[('share', '=', False)]"/>

                    <field name="active" invisible="1"/>
                    <field name="campaign_id" optional="hide"/>
                    <field name="referred" invisible="1"/>
                    <field name="medium_id" optional="show" options="{'no_open': True, 'no_create': True}"/>
                    <field name="source_id" optional="show" options="{'no_open': True, 'no_create': True}"/>
                    <!--<field name="customer_concern"/>-->
                    <field name="company_concern" widget="priority"/>

                    <field name="type_of_client"/>
                    <field string="Tipo de trabajo" name="work_type_id" options="{'create': False,'create_edit': False}"/>

                    <field string="Productos de interés" name="intrest_tag_ids" widget="many2many_tags" options="{'create': False,'create_edit': False}"/>
                    <field name="probability" string="Probability (%)" optional="hide"/>
                    <field name="message_needaction" invisible="1"/>
                    <field name="description" optional="hide"/>

                    <field name="priority" widget="priority"/>

                    <field name="tag_ids" string="Etiquetas" optional="show" widget="many2many_tags" options="{'create':False,'create_edit':False,'color_field': 'color'}"/>
                    <field name="activity_ids" widget="list_activity"/>
                    <field name="installation"/>
                    <field name="lead_stage_id" widget="badge"/>
                <field name="datetime_in_lead_stage" widget="remaining_days"/>

                </tree>
        </field>
    </record>
        <record model="ir.actions.act_window" id="crm_lead_my_leads">
            <field name="name">Leads</field>
            <field name="res_model">crm.lead</field>
            <field name="view_mode">kanban,tree,graph,pivot,calendar,form,activity</field>
            <field name="view_id" ref="roc_custom.crm_lead_tree_original"/>
            <field name="domain">['|', ('type','=','lead'), ('type','=',False)]</field>
            <field name="search_view_id" ref="crm.view_crm_case_leads_filter"/>
            <field name="context">{
                    'default_type':'lead',
                    'search_default_my_leads':1,
                    'search_default_lead_stage_id':1,
                }
            </field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create a Lead
                </p><p>
                    Leads are the qualification step before the creation of an opportunity.
                </p>
            </field>
        </record>
    <record id="crm_lead_lost_view" model="ir.ui.view">
        <field name="name">crm_lead_lost_view</field>
        <field name="model">crm.lead</field>
        <field name="arch" type="xml">
                <tree string="Leads perdidas" sample="1">
                    <field name="link_to_form" string="         " />
                     <field name="display_name" />
                    <field name="create_date" optional="hide"/>
                    <field name="create_date"  widget="remaining_days" optional="show"/>
                    <field name="date_closed"  optional="hide"/>
                    <field name="date_closed"  widget="remaining_days" optional="show"/>
                    <field name="lost_reason" string="Motivo de pérdida"/>
                    <field name="partner_id"/>
                    <field name="contact_name" optional="show"/>
                    <field name="phone_resume" widget="copy_phone"/>
                    <field name="team_id" optional="show" options="{'no_open': True, 'no_create': True}" domain="[('id','!=',False)]"/>
                    <field name="user_id" invisible="0" options="{'no_open': True, 'no_create': True}" domain="[('share', '=', False)]"/>
                    <field name="medium_id" optional="show" options="{'no_open': True, 'no_create': True}"/>
                    <field name="source_id" optional="show" options="{'no_open': True, 'no_create': True}"/>
                    <field name="company_concern" widget="priority"/>
                    <field name="type_of_client"/>
                    <field string="Tipo de trabajo" name="work_type_id" options="{'create': False,'create_edit': False}"/>
                    <field string="Productos de interés" name="intrest_tag_ids" widget="many2many_tags" options="{'create': False,'create_edit': False}"/>
                    <field name="priority" widget="priority"/>
                    <field name="tag_ids" string="Etiquetas" optional="show" widget="many2many_tags" options="{'create':False,'create_edit':False,'color_field': 'color'}"/>
                    <field name="activity_ids" widget="list_activity"/>

                </tree>
        </field>
    </record>

        <record model="ir.actions.act_window" id="crm_lost_opp">
            <field name="name">Oportunidades perdidas</field>
            <field name="res_model">crm.lead</field>
            <field name="view_mode">kanban,tree,graph,pivot,calendar,form,activity</field>
            <field name="view_id" ref="roc_custom.crm_lead_lost_view"/>
            <field name="domain">[('active','=',False)]</field>
            <field name="search_view_id" ref="crm.view_crm_case_leads_filter"/>
            <field name="context">{
                    'search_default_lost_reason':1,
                }
            </field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    No hay leads perdidas
                </p>
            </field>
        </record>

    <menuitem
            id ="menu_crm_leads_original"
            name = "Mis Leads"
            parent = "crm.crm_menu_root"
            action = "roc_custom.crm_lead_my_leads"/>

    <menuitem
            id ="menu_crm_leads_lost"
            name = "Oportunidades Perdidas"
            parent = "crm.crm_menu_sales"
            action = "roc_custom.crm_lost_opp"/>

<!--
    <record id="crm_lead_form_custom" model="ir.ui.view">
        <field name="name">crm_lead_form_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">

            <xpath expr="//field[@name='stage_id']" position="before">
                        <field name="lead_stage_id" widget="statusbar"
                               options="{'clickable': '1'}"
                               attrs="{'invisible': ['|', ('active', '=', False), ('type', '=', 'opportunity')]}"/>
            </xpath>

            <xpath expr="//header[last()]" position="inside">

            </xpath>
            <xpath expr="//group[@name='lead_partner']//field[@name='partner_id']" position="attributes">
                <attribute name="invisible">0</attribute>
                <attribute name="groups">base.group_user</attribute>
            </xpath>
            <xpath expr="//group[@name='categorization']//field[@name='medium_id']" position="replace">
            </xpath>
            <xpath expr="//page[@name='lead']//field[@name='medium_id']" position="replace">
            </xpath>
            <xpath expr="//group[@name='categorization']//field[@name='source_id']" position="replace">
            </xpath>
            <xpath expr="//page[@name='lead']//field[@name='source_id']" position="replace">
            </xpath>
            <xpath expr="//field[@name='team_id']" position="attributes">
                <attribute name="domain">[('id','!=',False)]</attribute>
            </xpath>
            <xpath expr="//button[@name='action_schedule_meeting']/.." position="inside">


            </xpath>


            <xpath expr="//field[@name='team_id']" position="after">


            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="attributes">
                <attribute name="options">{'create': False,'create_edit': False, 'color_field': 'color'}</attribute>
            </xpath>
            <xpath expr="//field[@name='user_id']" position="attributes">
                <attribute name="options">{'create': False,'create_edit': False}</attribute>
            </xpath>
            <xpath expr="//group[@name='lead_priority']//field[@name='tag_ids']"  position="attributes">
                <attribute name="options">{'create': False,'create_edit': False, 'color_field': 'color'}</attribute>
            </xpath>
            <xpath expr="//group[@name='lead_priority']//field[@name='tag_ids']" position="before">

            </xpath>

            <xpath expr="//group[@name='opportunity_partner']//field[@name='phone']//.." position="after">
                <field name="mobile"/>


            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="before">
                <field name="work_type_id" options="{'create': False,'create_edit': False}"/>
                <field name="installation"/>
                <field string="Productos de interés" name="intrest_tag_ids" widget="many2many_tags" options="{'create': False,'create_edit': False}"/>
                <field string="Origen" name="source_id" options="{'create': False,'create_edit': False}"/>
                <field string="Medio" name="medium_id" options="{'create': False,'create_edit': False}"/>
            </xpath>
            <xpath expr="//field[@name='website']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//button[@name='%(crm.crm_lead_lost_action)d']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//button[@name='action_set_lost']" position="replace">
                <button name="%(open_lost_wizard)d"  string="Perdido" type="action" class = "btn btn-danger" attrs = "{'invisible': [('active', '=', False)]}"/>
            </xpath>
            <xpath expr="//page[@name='lead']//field[@name='mobile']" position="after">
                <field name="phone" readonly="1"/>
            </xpath>
            <xpath expr="//field[@name='description']" position="before">
                <group>
                    <field name="lost_reason_id" options="{'no_create':True,'no_create_and_edit':True,'no_open':True}" attrs="{'invisible':[('lost_reason_id','=',False)]}"/>
                    <field name="lost_observations" options="{'no_create':True,'no_create_and_edit':True,'no_open':True}" attrs="{'invisible':[('lost_reason_id','=',False)]}"/>
                </group>
            </xpath>
        </field>
    </record>-->



    <record id="crm_lead_search_custom" model="ir.ui.view">
        <field name="name">crm_lead_search_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_case_leads_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='assigned_to_me']" position="before">
                <filter string="Leads" name="leads" domain="[('type','=','lead')]"/>
                <filter string="Oportunidades" name="opportunities" domain="[('type','=','opportunity')]"/>
                 <separator orientation="vertical"/>
            </xpath>
            <xpath expr="//filter[@name='date_closed']" position="before">
                        <filter string="Fecha conversión" name="date_conversion" context="{'group_by':'date_conversion:week'}"/>
            </xpath>
            <xpath expr="//filter[@name='assigned_to_me']" position="after">
                    <filter string="Mis Leads" name="my_leads" domain="['|',('activity_user_id','=',uid),('user_id','=',uid)]" help="Próxima tarea mía o soy el comercial"/>
            </xpath>
            <xpath expr="//field[@name='phone_mobile_search']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='country_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='city']" position="before">
                    <field name="zip" string="Código postal"/>
            </xpath>
            <xpath expr="//field[@name='name']" position="after">
                    <field name="phone_mobile_search"/>
                    <field name="street" string="Dirección"/>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="after">
                    <field name="referred_professional"/>
                    <field string="Productos de interés" name="intrest_tag_ids" filter_domain="[('intrest_tag_ids', 'ilike', self)]"/>
            </xpath>
            <xpath expr="//filter[@name='unassigned_leads']" position="after">
                <separator orientation="vertical"/>
                <filter string="Seguimiento especial" name="tag_closer_follow" domain="[('tag_ids.closer_follow','=',True)]"/>
                <separator orientation="vertical"/>
                <filter string="Busca instalación" name="installation" domain="[('installation','=',True)]"/>
                <filter string="Sin instalación" name="no_installation" domain="[('installation','!=',True)]"/>
                <separator orientation="vertical"/>
                    <filter string="Asociadas a profesional" name="with_referred_professional" domain="[('referred_professional', '!=', False)]"/>
                <separator orientation="vertical"/>
                    <!--<filter string="Alto interés" name="high_customer_concern" domain="[('customer_concern','=','high')]" />-->
                    <filter string="Alto interés Roconsa" name="high_company_concern" domain="[('company_concern','in',['3','4','5'])]" />
                    <filter string="Alta prioridad" name="high_priority" domain="['|',('priority','=',3),('priority','=',2)]" />
                <separator orientation="vertical"/>
                    <filter string="Cliente Profesional" name="type_client_profesional" domain="[('type_of_client','=','profesional')]" />
                    <filter string="Cliente Preferente" name="type_client_preferential" domain="[('type_of_client','=','preferential')]" />
                    <filter string="Cliente VIP" name="type_client_vip" domain="[('type_of_client','=','vip')]" />
            </xpath>

            <xpath expr="//filter[@name='city']" position="before">
                <separator orientation="vertical"/>
                <filter string="Código postal" name="zip" context="{'group_by':'zip'}"/>
            </xpath>
            <xpath expr="//filter[@name='compaign']" position="before">
                <separator orientation="vertical"/>
            </xpath>
            <xpath expr="//filter[@name='salesperson']" position="before">
                <filter string="Nombre" name="name" context="{'group_by':'name'}"/>
                <separator orientation="vertical"/>
            </xpath>
            <xpath expr="//filter[@name='date_closed']" position="after">
                <separator orientation="vertical"/>
                    <filter string="Etapa Lead" name="lead_stage_id" context="{'group_by':'lead_stage_id'}"/>
                <separator orientation="vertical"/>
                    <filter string="Tipo" name="type" context="{'group_by':'type'}"/>
                <separator orientation="vertical"/>
                    <filter string="Prioridad" name="priority" context="{'group_by':'priority'}"/>
                    <!--<filter string="Interés Cliente" name="customer_concern" context="{'group_by':'customer_concern'}"/>-->
                    <filter string="Interés Roconsa" name="company_concern" context="{'group_by':'company_concern'}"/>
                    <filter string="Tipo Cliente" name="type_of_client" context="{'group_by':'type_of_client'}"/>
                <separator orientation="vertical"/>
                <filter string="Por profesional" name="referred_professional" domain="[('referred_professional', '!=', False)]" context="{'group_by':'referred_professional'}"/>
                <separator orientation="vertical"/>
                <filter string="Tipo de trabajo" name="work_type_id" context="{'group_by':'work_type_id'}"/>
                <filter string="Productos de interés" name="intrest_tag_ids" context="{'group_by':'intrest_tag_ids'}"/>
                <filter string="Etiquetas" name="tag_ids" context="{'group_by':'tag_ids'}"/>
                <separator orientation="vertical"/>
                <filter string="Motivo de pérdida" name="lost_reason" domain="['&amp;', ('probability', '=', 0), ('active', '=', False)]" context="{'group_by':'lost_reason'}"/>
                <separator orientation="vertical"/>
                <filter string="Tiempo en etapa" name="datetime_in_lead_stage" context="{'group_by':'datetime_in_lead_stage'}"/>
            </xpath>
        </field>
    </record>
    <record id="crm_opportunity_search_custom" model="ir.ui.view">
        <field name="name">crm_opportunity_search_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_case_opportunities_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='salesperson']" position="before">
                <filter string="Nombre" name="name" context="{'group_by':'name'}"/>
                <separator orientation="vertical"/>
            </xpath>
            <xpath expr="//field[@name='phone_mobile_search']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='country_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='city']" position="before">
                    <field name="zip" string="Código postal"/>
            </xpath>
            <xpath expr="//field[@name='name']" position="after">
                    <field name="phone_mobile_search"/>
                    <field name="street" string="Dirección"/>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="after">
                    <field name="referred_professional"/>
                    <field string="Productos de interés" name="intrest_tag_ids" filter_domain="[('intrest_tag_ids', 'ilike', self)]"/>
            </xpath>
            <xpath expr="//filter[@name='inactive']" position="after">
                <separator orientation="vertical"/>
                <filter string="Seguimiento especial" name="tag_closer_follow" domain="[('tag_ids.closer_follow','=',True)]"/>
                <separator orientation="vertical"/>
                <!--
                <filter string="Sin visitas programadas" name="no_visit" domain="[('visit_status','=','Sin visitas programadas')]"/>
                <filter string="Visita programada" name="waiting_visit" domain="[('visit_status','=','A visitar')]"/>
                <filter string="Visitado" name="visited" domain="[('visit_status','=','Visitado')]"/>-->
                <separator orientation="vertical"/>
                <filter string="Busca instalación" name="installation" domain="[('installation','=',True)]"/>
                <filter string="Sin instalación" name="no_installation" domain="[('installation','!=',True)]"/>
                <separator orientation="vertical"/>
                    <filter string="Asociadas a profesional" name="with_referred_professional" domain="[('referred_professional', '!=', False)]"/>
                <separator orientation="vertical"/>
                    <!--<filter string="Alto interés" name="high_customer_concern" domain="[('customer_concern','=','high')]" />-->
                    <filter string="Alto interés Roconsa" name="high_company_concern" domain="[('company_concern','in',['1','2','3'])]" />
                    <filter string="Alta prioridad" name="high_priority" domain="['|',('priority','=',3),('priority','=',2)]" />
                <separator orientation="vertical"/>
                    <filter string="Alta seguridad" name="high_sec" domain="['|',('safety_level','=','medium'),('safety_level','=','high')]" />
                    <filter string="Contacto cualificado" name="high_contact" domain="['|',('type_of_contact','=','qualified'),('type_of_contact','=','highly qualified')]" />
                <separator orientation="vertical"/>
                    <filter string="Cliente Profesional" name="type_client_profesional" domain="[('type_of_client','=','profesional')]" />
                    <filter string="Cliente Preferente" name="type_client_preferential" domain="[('type_of_client','=','preferential')]" />
                    <filter string="Cliente VIP" name="type_client_vip" domain="[('type_of_client','=','vip')]" />
            </xpath>

            <xpath expr="//filter[@name='city']" position="before">
                <separator orientation="vertical"/>
                <filter string="Código postal" name="zip" context="{'group_by':'zip'}"/>
            </xpath>
            <xpath expr="//filter[@name='compaign']" position="before">
                <separator orientation="vertical"/>
            </xpath>
            <xpath expr="//filter[@name='date_closed']" position="after">
                <separator orientation="vertical"/>
                    <!--<filter string="Interés Cliente" name="customer_concern" context="{'group_by':'customer_concern'}"/>-->
                    <filter string="Interés Roconsa" name="company_concern" context="{'group_by':'company_concern'}"/>
                    <filter string="Tipo Cliente" name="type_of_client" context="{'group_by':'type_of_client'}"/>
                    <filter string="Nivel seguridad" name="safety_level" context="{'group_by':'safety_level'}"/>
                    <filter string="Calidad contacto" name="type_of_contact" context="{'group_by':'type_of_contact'}"/>
                    <filter string="Prioridad" name="priority" context="{'group_by':'priority'}"/>
                <separator orientation="vertical"/>
                <filter string="Por profesional" name="referred_professional" domain="[('referred_professional', '!=', False)]" context="{'group_by':'referred_professional'}"/>
                <separator orientation="vertical"/>
                <filter string="Tipo de trabajo" name="work_type_id" context="{'group_by':'work_type_id'}"/>
                <filter string="Productos de interés" name="intrest_tag_ids" context="{'group_by':'intrest_tag_ids'}"/>
                <filter string="Etiquetas" name="tag_ids" context="{'group_by':'tag_ids'}"/>
                <separator orientation="vertical"/>
                <!--
                <filter string="Estado visita" name="visit_status_date" context="{'group_by':'visit_status_date'}"/>
                <filter string="Personal visita" name="visit_user_ids" context="{'group_by':'visit_user_ids'}"/>
                <filter string="Vehículo" name="visit_vehicle" context="{'group_by':'visit_vehicle'}"/>-->

                <separator orientation="vertical"/>
                <filter string="Motivo de pérdida" name="lost_reason" domain="['&amp;', ('probability', '=', 0), ('active', '=', False)]" context="{'group_by':'lost_reason'}"/>
            </xpath>
        </field>
    </record>

    <record id="crm_opportunity_kanban_custom" model="ir.ui.view">
        <field name="name">crm_opportunity_kanban_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_kanban_view_leads"/>
        <field name="arch" type="xml">

                <xpath expr="//kanban[last()]" position="attributes">
                    <attribute name="quick_create">false</attribute>
                </xpath>


            <progressbar field="activity_state" position="replace">
                <progressbar field="activity_state" colors="{&quot;planned&quot;: &quot;success&quot;, &quot;today&quot;: &quot;warning&quot;, &quot;overdue&quot;: &quot;danger&quot;}" shelp="This bar allows to filter the opportunities based on scheduled activities."/>
            </progressbar>
            <field name="activity_ids" position="after">
                <field name="referred_professional"/>
            </field>
        <field name="tag_ids" position="before">
                <div attrs="{'invisible':[('referred_professional','=',False)]}">
                    <strong>Referido por
                    <field name="referred_professional"/></strong>
                </div>
        </field>
            <field name="tag_ids" position="after">
                <div attrs="{'invisible':[('phone_resume','=',False)]}" >
                    <field name="phone_resume" widget="copy_phone"/>
                </div>
                            </field>
                <xpath expr="//div[hasclass('oe_kanban_footer')]//field[@name='priority']" position="before">
                    <span>Cliente</span>
                </xpath>

                <xpath expr="//div[hasclass('oe_kanban_footer')]" position="inside">
                    <div class="o_kanban_record_subtitle">
                        <!--<field name="intrest_tag_ids" widget="many2many_tags"/>-->
                        <strong><field name="team_id" widget="badge"/></strong>
                        <span> | </span><field widget="priority" name="company_concern"/>
                        <!--<field name="work_type_id" widget="badge" attrs="{'invisible':[('work_type_id','=',False)]}"/>-->
                        <br/>
                        <!--
                        <div>
                            <span attrs="{'invisible':['|',('type_of_client','=',False),('customer_concern','=',False)]}"> | </span>
                        <span attrs="{'invisible':[('type_of_client','=',False)]}" >Cliente </span><strong><field attrs="{'invisible':[('type_of_client','=',False)]}" name="type_of_client"/></strong></div>-->
                    </div>
                    <!--<div class="o_kanban_record_subtitle" attrs="{'invisible':[('stage_name','!=','Visita')]}">
                        <field name="visit_status_date"/>
                        <field name="stage_name" invisible="1"/>
                    </div>-->
                </xpath>
                <xpath expr="//field[@name='name']" position="after">
                    <span>  </span>
                    <field name="datetime_in_stage" widget="remaining_days"/>
                </xpath>
        </field>
    </record>

<record id="crm_lead_dashboard_view_custom" model="ir.ui.view">
        <field name="name">crm_lead_dashboard_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm_enterprise.crm_lead_dashboard_view"/>
        <field name="arch" type="xml">

            <xpath expr="//aggregate[@name='leads']" position="attributes">
                <attribute name="string">Ingresaron</attribute>
            </xpath>

            <xpath expr="//aggregate[@name='expected_revenue']" position="replace">
            </xpath>
            <xpath expr="//aggregate[@name='prorated_revenue']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//aggregate[@name='days_to_convert']" position="replace">
            </xpath>
            <xpath expr="//aggregate[@name='days_to_assign']" position="replace">
            </xpath>

            <xpath expr="//aggregate[@name='leads']" position="after">
                <aggregate name="no_count" string="No corresponden" field="id" domain="[('active','=',False),('lost_reason.is_not_a_lost','=',True)]" group_operator="count" invisible="0"/>
                <aggregate name="qty_opp" string="Convertidos" field="id" domain="[('type','=','opportunity')]" group_operator="count" invisible="0"/>
                <aggregate name="won" string="Ganados" field="id" domain="[('won_status','=','won')]" group_operator="count" invisible="0"/>
                <aggregate name="lost" string="Perdidos" field="id" domain="[('active','=',False),('lost_reason.is_not_a_lost','=',False)]" group_operator="count" invisible="0"/>
            </xpath>

            <xpath expr="//formula[@name='opportunity_percent']" position="replace">
                <aggregate name="expected_revenue" string="Ventas estimadas" field="expected_revenue" group_operator="sum" widget="monetary"/>
                <formula name="valid_percent" string="Validez" value="record.no_count/(record.leads)" widget="percentage"/>
                <formula name="opportunity_percent" string="Conversión" value="record.opportunities/(record.leads - record.no_count)" widget="percentage"/>
                <formula name="won_percent" string="Ganados" value="record.won/(record.leads - record.no_count)" widget="percentage"/>
                <formula name="lost_percent" string="Pérdida" value="record.lost/(record.leads - record.no_count)" widget="percentage"/>
                <aggregate name="days_to_assign" domain="['|',('lost_reason.is_not_a_lost','!=', True),('lost_reason','=', False)]" string="Días de asignación" field="day_open" group_operator="avg" value_label="days"/>
                <aggregate name="days_to_convert" domain="['|',('lost_reason.is_not_a_lost','!=', True),('lost_reason','=', False)]" string="Días de conversión" group_operator="avg" field="days_to_convert"/>
            </xpath>
        </field>
</record>
<record id="crm_lead_dashboard_opp_view_custom" model="ir.ui.view">
        <field name="name">crm_lead_dashboard_custom_opportunity</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm_enterprise.crm_opportunity_view_dashboard"/>
        <field name="arch" type="xml">

            <xpath expr="//aggregate[@name='days_to_close']" position="before">
                <aggregate name="days_to_convert" string="Days To Opportunity" group_operator="avg" field="days_to_convert"/>
                <aggregate name="qty_opp" string="Convertidos" field="id" domain="[('type','=','opportunity')]" group_operator="count" invisible="0"/>
            </xpath>
            <xpath expr="//aggregate[@name='days_exceeding_closing']" position="after">
                <aggregate name="lost" string="Perdidos" field="id" domain="[('active','=',False),('lost_reason.is_not_a_lost','=',False)]" group_operator="count" invisible="0"/>
                <aggregate name="won" string="Ganados" field="id" domain="[('won_status','=','won')]" group_operator="count" invisible="0"/>
            </xpath>
        </field>
</record>



</odoo>