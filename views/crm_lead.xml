<?xml version="1.0"?>
<odoo>
    <record id="crm_lead_tree_custom" model="ir.ui.view">
        <field name="name">crm_lead_tree_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_leads"/>
        <field name="arch" type="xml">
            <xpath expr="//tree[last()]" position="replace">
                <tree string="Leads" sample="1" multi_edit="1" editable="top">
                    <field name="link_to_form" string="         " />
                     <field name="date_deadline" invisible="1"/>
                    <field name="create_date" optional="show"/>
                    <field name="name" string="Lead"/>
                    <field name="contact_name" optional="hide"/>
                    <field name="partner_name" optional="hide"/>
                    <field name="email_from" optional="show"/>
                    <field name="phone_resume" widget="copy_phone"/>
                    <field name="company_id" groups="base.group_multi_company" optional="hide"/>
                    <field name="zip" optional="show"/>
                    <field name="city" optional="show"/>
                    <field name="state_id" optional="hide" options="{'no_open': True, 'no_create': True}"/>
                    <field name="country_id" optional="hide" options="{'no_open': True, 'no_create': True}"/>
                    <field name="partner_id" invisible="1"/>
                    <!-- Explicit domain due to multi edit -> real company domain would be complicated -->
                    <field name="user_id" optional="hide" widget="many2one_avatar_user" options="{'no_open': True, 'no_create': True}" domain="[('share', '=', False)]"/>
                    <field name="team_id" optional="show" options="{'no_open': True, 'no_create': True}" domain="[('id','!=',False)]"/>
                    <field name="active" invisible="1"/>
                    <field name="campaign_id" optional="hide"/>
                    <field name="referred" invisible="1"/>
                    <field name="medium_id" optional="show" options="{'no_open': True, 'no_create': True}"/>
                    <field name="source_id" optional="show" options="{'no_open': True, 'no_create': True}"/>
                    <field string="Tipo de trabajo" name="work_type_id" options="{'create': False,'create_edit': False}"/>
                    <field name="installation"/>
                    <field string="Productos de interés" name="intrest_tag_ids" widget="many2many_tags" options="{'create': False,'create_edit': False}"/>
                    <field name="probability" string="Probability (%)" optional="hide"/>
                    <field name="message_needaction" invisible="1"/>
                    <field name="description" widget="text_widget" />

                    <field name="priority" widget="priority"/>

                    <field name="tag_ids" string="Etiquetas" optional="show" widget="many2many_tags" options="{'create':False,'create_edit':False,'color_field': 'color'}"/>
                    <field name="activity_ids" widget="list_activity"/>
                </tree>

            </xpath>
        </field>
    </record>




    <record id="crm_lead_form_custom" model="ir.ui.view">
        <field name="name">crm_lead_form_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">



            <xpath expr="//group[@name='lead_partner']//field[@name='partner_id']" position="attributes">
                <attribute name="invisible">0</attribute>
            </xpath>
            <xpath expr="//group[@name='categorization']//field[@name='medium_id']" position="replace">
            </xpath>
            <xpath expr="//page[@name='lead']//field[@name='medium_id']" position="replace">
            </xpath>
            <xpath expr="//group[@name='categorization']//field[@name='source_id']" position="replace">
            </xpath>
            <xpath expr="//page[@name='lead']//field[@name='source_id']" position="replace">
            </xpath>
            <xpath expr="//field[@name='team_id']" position="attributes">
                <attribute name="domain">[('id','!=',False)]</attribute>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="attributes">
                <attribute name="options">{'create': False,'create_edit': False, 'color_field': 'color'}</attribute>
            </xpath>
            <xpath expr="//field[@name='user_id']" position="attributes">
                <attribute name="options">{'create': False,'create_edit': False}</attribute>
            </xpath>
            <xpath expr="//group[@name='lead_priority']//field[@name='tag_ids']"  position="attributes">
                <attribute name="options">{'create': False,'create_edit': False, 'color_field': 'color'}</attribute>
            </xpath>
            <xpath expr="//group[@name='lead_priority']//field[@name='tag_ids']" position="before">
                <field name="work_type_id" options="{'create': False,'create_edit': False}"/>
                <field name="installation"/>
                <field string="Productos de interés" name="intrest_tag_ids" widget="many2many_tags" options="{'create': False,'create_edit': False}"/>
                <field string="Origen" name="source_id" options="{'create': False,'create_edit': False}"/>
                <field string="Medio" name="medium_id" options="{'create': False,'create_edit': False}"/>
            </xpath>
            <xpath expr="//group[@name='opportunity_partner']//field[@name='phone']//.." position="after">
                <field name="mobile"/>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="before">
                <field name="work_type_id" options="{'create': False,'create_edit': False}"/>
                <field name="installation"/>
                <field string="Productos de interés" name="intrest_tag_ids" widget="many2many_tags" options="{'create': False,'create_edit': False}"/>
                <field string="Origen" name="source_id" options="{'create': False,'create_edit': False}"/>
                <field string="Medio" name="medium_id" options="{'create': False,'create_edit': False}"/>
            </xpath>
            <xpath expr="//field[@name='website']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//button[@name='%(crm.crm_lead_lost_action)d']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//button[@name='action_set_lost']" position="replace">
                <button name="%(open_lost_wizard)d"  string="Perdido" type="action" class = "btn btn-danger" attrs = "{'invisible': [('active', '=', False)]}"/>
            </xpath>
            <xpath expr="//page[@name='lead']//field[@name='mobile']" position="after">
                <field name="phone" readonly="1"/>
            </xpath>
            <xpath expr="//field[@name='description']" position="before">
                <group>
                    <field name="lost_reason_id" options="{'no_create':True,'no_create_and_edit':True,'no_open':True}" attrs="{'invisible':[('lost_reason_id','=',False)]}"/>
                    <field name="lost_observations" options="{'no_create':True,'no_create_and_edit':True,'no_open':True}" attrs="{'invisible':[('lost_reason_id','=',False)]}"/>
                </group>
            </xpath>
            <field name="date_deadline" position="after">
                <field name="pending_visit_date" readonly="1"/>
            </field>

            <xpath expr="//page[last()]" position="after">
                <page string="Campos a eliminar">
                    <group>
                        <field name="customer_concern"/>
                        <field name="type_of_client"/>
                        <field name="source_url"/>
                        <field name="request"/>
                        <field name="type_of_contact"/>
                        <field name="safety_level"/>
                        <field name="category_id"/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <record id="crm_lead_search_custom" model="ir.ui.view">
        <field name="name">crm_lead_search_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_case_leads_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='phone_mobile_search']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='country_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='city']" position="before">
                    <field name="zip" string="Código postal"/>
            </xpath>
            <xpath expr="//field[@name='name']" position="after">
                    <field name="phone_mobile_search"/>
                    <field name="street" string="Dirección"/>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="after">
                    <field string="Productos de interés" name="intrest_tag_ids" filter_domain="[('intrest_tag_ids', 'ilike', self)]"/>
            </xpath>
            <xpath expr="//filter[@name='city']" position="after">
                <filter string="Código postal" name="zip" context="{'group_by':'zip'}"/>
            </xpath>
            <xpath expr="//filter[@name='date_closed']" position="after">
                <separator orientation="vertical"/>
                <filter string="Productos de interés" name="intrest_tag_ids" context="{'group_by':'intrest_tag_ids'}"/>
                <separator orientation="vertical"/>
                <filter string="Motivo de pérdida" name="lost_reason_id" domain="['&amp;', ('probability', '=', 0), ('active', '=', False)]" context="{'group_by':'lost_reason_id'}"/>
            </xpath>
        </field>
    </record>
    <record id="crm_opportunity_search_custom" model="ir.ui.view">
        <field name="name">crm_opportunity_search_custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_case_opportunities_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='phone_mobile_search']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='country_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='city']" position="before">
                    <field name="zip" string="Código postal"/>
            </xpath>
            <xpath expr="//field[@name='name']" position="after">
                    <field name="phone_mobile_search"/>
                    <field name="street" string="Dirección"/>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="after">
                    <field string="Productos de interés" name="intrest_tag_ids" filter_domain="[('intrest_tag_ids', 'ilike', self)]"/>
            </xpath>
            <xpath expr="//filter[@name='inactive']" position="before">
                <filter string="Busca instalación" name="installation" domain="[('installation','=',True)]"/>
                <filter string="Sin instalación" name="no_installation" domain="[('installation','!=',True)]"/>
                <separator orientation="vertical"/>
            </xpath>
            <xpath expr="//filter[@name='date_closed']" position="after">
                <separator orientation="vertical"/>
                <filter string="Etiquetas" name="tag_ids" context="{'group_by':'tag_ids'}"/>
                <filter string="Productos de interés" name="intrest_tag_ids" context="{'group_by':'intrest_tag_ids'}"/>
                <separator orientation="vertical"/>
                <filter string="URL de procedencia" name="source_url" context="{'group_by':'source_url'}"/>
                <separator orientation="vertical"/>
                <filter string="Interés del cliente" name="customer_concern" context="{'group_by':'customer_concern'}"/>
                <filter string="Tipo de cliente" name="type_of_client" context="{'group_by':'type_of_client'}"/>
                <filter string="Tipo de contacto" name="type_of_contact" context="{'group_by':'type_of_contact'}"/>
                <filter string="Nivel de seguridad" name="safety_level" context="{'group_by':'safety_level'}"/>
                <filter string="Tipo de obra" name="work_type_id" context="{'group_by':'work_type_id'}"/>
                <filter string="Categoría" name="category_id" context="{'group_by':'category_id'}"/>
                <separator orientation="vertical"/>
                <filter string="Fecha de cambio a pendiente de visita" name="pending_visit_date"  context="{'group_by':'pending_visit_date'}"/>
                <separator orientation="vertical"/>
                <filter string="Motivo de pérdida" name="lost_reason_id" domain="['|', ('probability', '=', 0), ('active', '=', False)]" context="{'group_by':'lost_reason_id'}"/>
            </xpath>
        </field>
    </record>
</odoo>